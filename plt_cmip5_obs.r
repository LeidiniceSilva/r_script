# Author      = Leidinice Silva
# Email       = leidinicesilva@gmail.com
# Date        = 02/06/2019
# Description = Plot Taylor differents comparation methods from cmip5 models end obs basedata


# INIT #

rm(list=ls(all=TRUE))

require("hydroGOF")

library("forecast")
library("plotrix")
library("gof")

# Open and read data
data = read.table("precip_cmip5_month_1975_2005.csv", header=TRUE, dec=",", sep=";")
attach(data)
names(data)

# Plot precipitation boxplot
png("/home/nice/Documentos/ufrn/PhD_project/results/cmip5/plt_boxplot_precip_cmip5_cru_1975-2005.png", width=18,height=12, units="cm", res=600) 
models = cbind(data[,3],data[,4],data[,5],data[,6],data[,7],data[,8],data[,9],data[,10],data[,11],data[,12],data[,13],data[,14],data[,15],data[,16],data[,17],data[,18],data[,19],data[,20],data[,21],data[,22],data[,23],data[,24],data[,25],data[,26],data[,27],data[,28],data[,29],data[,30],data[,31],data[,32],data[,33],data[,34],data[,35],data[,36])
boxplot(models, col="gray80", ylim=c(0,12), main="Rainfall Boxplot - CMIP5-hist x CRU-ts4.02\n1975-2005 (Reference period:1850-2005)\nAMZ_NEB (-85,-15,-20,10)", xlab="Models", ylab="Rain (mm/day)", xaxt="n", cex=1, cex.main=1)
grid(nx=34, ny=12, lty=4, col="gray90") 
par(new=TRUE)
boxplot(models, col="gray80", ylim=c(0,12), main="Rainfall Boxplot - CMIP5-hist x CRU-ts4.02\n1975-2005 (Reference period:1850-2005)\nAMZ_NEB (-85,-15,-20,10)", xlab="Models", ylab="Rain (mm/day)", xaxt="n", cex=1, cex.main=1)
lablist.x<-as.vector(c("BCC-CSM1.1","BCC-CSM1.1M","BNU-ESM","Can-ESM2","CNRM-CM5","CSIRO-ACESS-1","CSIRO-ACESS-3","CSIRO-MK36","FIO-ESM",
                       "GISS-E2-H","GISS-E2-H-CC","GISS-E2-R","HadGEM-AO","HadGEM-CC","HadGEM-ES","INMCM4","IPSL-CM5A-LR","IPSL-CM5A-MR","IPSL-CM5B-LR","LASG-FGOALS-G2",
                       "LASG-FGOALS-S2","MIROC5","MIROC-ESM","MIROC-ESM-CHEM","MPI-ESM-LR","MPI-ESM-MR","MRI-CGCM3","NCAR-CCSM4","NCAR-CESM1-BGC","NCAR-CESM1-CAM5",
                       "NoESM1-M","NorESM1-ME","ENSEMEAN-CMIP5","CRU-ts4.02"))
axis(2, at=seq(1,34,by=1), labels=FALSE)
text(x=seq(1, 34, by=1), par("usr")[1], labels=lablist.x, srt=45, pos=2, cex=0.5, xpd=TRUE)
dev.off()

# Plot precipitation climatology
png("/home/nice/Documentos/ufrn/PhD_project/results/cmip5/plt_lines_clim_precip_cmip5_cru_1975-2005.png", width=18,height=12, units="cm", res=600) 
round(aggregate(x=data, by=list(data[,2]), FUN="mean")[,-(1:2)],2)
clim = aggregate(x=data, by=list(data[,2]), FUN="mean")[,-(1:2)] 
plot(clim[,2], type="l", col="gray80", lwd=2, ylim=c(0,12), main="Rainfall Climatology - CMIP5-hist x CRU-ts4.02\n1975-2005 (Reference period:1850-2005)\nAMZ_NEB (-85,-15,-20,10)", xlab="Months", ylab="Rain (mm/day)", xaxt="n", cex=1, cex.main=1)
grid(nx=12, ny=12, lty=4, col="gray90") 
par(new=TRUE)
plot(clim[,2], type="l", col="gray80", lwd=2, ylim=c(0,12), main="Rainfall Climatology - CMIP5-hist x CRU-ts4.02\n1975-2005 (Reference period:1850-2005)\nAMZ_NEB (-85,-15,-20,10)", xlab="Months", ylab="Rain (mm/day)", xaxt="n", cex=1, cex.main=1)
lines(clim[,3], type="l", col="gray80", lwd=2)
lines(clim[,4], type="l", col="gray80", lwd=2)
lines(clim[,5], type="l", col="gray80", lwd=2)
lines(clim[,6], type="l", col="gray80", lwd=2)
lines(clim[,7], type="l", col="gray80", lwd=2)
lines(clim[,8], type="l", col="gray80", lwd=2)
lines(clim[,9], type="l", col="gray80", lwd=2)
lines(clim[,10], type="l", col="gray80", lwd=2)
lines(clim[,11], type="l", col="gray80", lwd=2)
lines(clim[,12], type="l", col="gray80", lwd=2)
lines(clim[,13], type="l", col="gray80", lwd=2)
lines(clim[,14], type="l", col="gray80", lwd=2)
lines(clim[,15], type="l", col="gray80", lwd=2)
lines(clim[,16], type="l", col="blue", lwd=3)
lines(clim[,17], type="l", col="gray80", lwd=2)
lines(clim[,18], type="l", col="gray80", lwd=2)
lines(clim[,19], type="l", col="gray80", lwd=2)
lines(clim[,20], type="l", col="gray80", lwd=2)
lines(clim[,21], type="l", col="gray80", lwd=2)
lines(clim[,22], type="l", col="gray80", lwd=2)
lines(clim[,23], type="l", col="gray80", lwd=2)
lines(clim[,24], type="l", col="gray80", lwd=2)
lines(clim[,25], type="l", col="gray80", lwd=2)
lines(clim[,26], type="l", col="gray80", lwd=2)
lines(clim[,27], type="l", col="darkgreen", lwd=3)
lines(clim[,28], type="l", col="gray80", lwd=2)
lines(clim[,29], type="l", col="gray80", lwd=2)
lines(clim[,30], type="l", col="gray80", lwd=2)
lines(clim[,31], type="l", col="gray80", lwd=2)
lines(clim[,32], type="l", col="gray80", lwd=2)
lines(clim[,33], type="l", col="gray80", lwd=2)
lines(clim[,34], type="l", col="red", lwd=3)
lines(clim[,35], type="b", col="black", lwd=3, pch=20)
axis(at=1:12, labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"), side=1, line=0)
legend("top", c("CMIP5-hist","HadGEM-ES","MPI-ESM-MR","ENSMEAN-CMIP5", "CRU-ts4.02"), col=c("gray","blue","darkgreen","red","black"), lwd=c(2,3,3,3,3), pch=c(NA,NA,NA,NA,20), ncol=3, cex=1) 
dev.off()

# Creating time series
mdl1 = ts(data[,3], frequency=12, start=c(1976,1))
mdl2 = ts(data[,4], frequency=12, start=c(1976,1))
mdl3 = ts(data[,5], frequency=12, start=c(1976,1))
mdl4 = ts(data[,6], frequency=12, start=c(1976,1))
mdl5 = ts(data[,7], frequency=12, start=c(1976,1))
mdl6 = ts(data[,8], frequency=12, start=c(1976,1))
mdl7 = ts(data[,9], frequency=12, start=c(1976,1))
mdl8 = ts(data[,10], frequency=12, start=c(1976,1))
mdl9 = ts(data[,11], frequency=12, start=c(1976,1))
mdl10 = ts(data[,12], frequency=12, start=c(1976,1))
mdl11 = ts(data[,13], frequency=12, start=c(1976,1))
mdl12 = ts(data[,14], frequency=12, start=c(1976,1))
mdl13 = ts(data[,15], frequency=12, start=c(1976,1))
mdl14 = ts(data[,16], frequency=12, start=c(1976,1))
mdl15 = ts(data[,17], frequency=12, start=c(1976,1))
mdl16 = ts(data[,18], frequency=12, start=c(1976,1))
mdl17 = ts(data[,19], frequency=12, start=c(1976,1))
mdl18 = ts(data[,20], frequency=12, start=c(1976,1))
mdl19 = ts(data[,21], frequency=12, start=c(1976,1))
mdl20 = ts(data[,22], frequency=12, start=c(1976,1))
mdl21 = ts(data[,23], frequency=12, start=c(1976,1))
mdl22 = ts(data[,24], frequency=12, start=c(1976,1))
mdl23 = ts(data[,25], frequency=12, start=c(1976,1))
mdl24 = ts(data[,26], frequency=12, start=c(1976,1))
mdl25 = ts(data[,27], frequency=12, start=c(1976,1))
mdl26 = ts(data[,28], frequency=12, start=c(1976,1))
mdl27 = ts(data[,29], frequency=12, start=c(1976,1))
mdl28 = ts(data[,30], frequency=12, start=c(1976,1))
mdl29 = ts(data[,31], frequency=12, start=c(1976,1))
mdl30 = ts(data[,32], frequency=12, start=c(1976,1))
mdl31 = ts(data[,33], frequency=12, start=c(1976,1))
mdl32 = ts(data[,34], frequency=12, start=c(1976,1))
mdl33 = ts(data[,35], frequency=12, start=c(1976,1))
obs1 = ts(data[,36], frequency=12, start=c(1976,1))

# Plot Taylor Diagram
png("/home/nice/Documentos/ufrn/PhD_project/results/cmip5/plt_diag_taylor_precip_cmip5_cru_1975-2005.png", width=14,height=12, units="cm", res=600) 																									  								
taylor.diagram(obs1, mdl1, pos.cor=T, show.gamma=TRUE, gamma.col="black", ngamma=3, sd.arcs=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, ref.sd=TRUE, col="antiquewhite4", pch=19, main="Taylor Diagram AMZ_NEB (-85,-15,-20,10)", line=2, mar=c(4,4,3,8), xlab="SD (Normalized)", ylab="SD (Normalized)", cex=1, cex.main=1) 
taylor.diagram(obs1, mdl2, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="aquamarine4", pch=19)
taylor.diagram(obs1, mdl3, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="azure4", pch=19)
taylor.diagram(obs1, mdl4, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="bisque3", pch=19)
taylor.diagram(obs1, mdl5, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="violet", pch=19)
taylor.diagram(obs1, mdl6, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="yellow", pch=19)
taylor.diagram(obs1, mdl7, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="brown", pch=19)
taylor.diagram(obs1, mdl8, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="coral", pch=19)
taylor.diagram(obs1, mdl9, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkgray", pch=19)
taylor.diagram(obs1, mdl10, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="green", pch=19)
taylor.diagram(obs1, mdl11, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="red", pch=19)
taylor.diagram(obs1, mdl12, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkkhaki", pch=19)
taylor.diagram(obs1, mdl13, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkolivegreen1", pch=19)
taylor.diagram(obs1, mdl14, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="yellowgreen", pch=19)
taylor.diagram(obs1, mdl15, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="aliceblue", pch=19)
taylor.diagram(obs1, mdl16, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="turquoise3", pch=19)
taylor.diagram(obs1, mdl17, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="blue", pch=19)
taylor.diagram(obs1, mdl18, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="peachpuff3", pch=19)
taylor.diagram(obs1, mdl19, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="slategray2", pch=19)
taylor.diagram(obs1, mdl20, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="wheat4", pch=19)
taylor.diagram(obs1, mdl21, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="yellow4", pch=19)
taylor.diagram(obs1, mdl22, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="violetred4", pch=19)
taylor.diagram(obs1, mdl23, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkblue", pch=19)
taylor.diagram(obs1, mdl24, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="cyan", pch=19)
taylor.diagram(obs1, mdl25, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkolivegreen", pch=19)
taylor.diagram(obs1, mdl26, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkmagenta", pch=19)
taylor.diagram(obs1, mdl27, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkorange4", pch=19)
taylor.diagram(obs1, mdl28, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="gray", pch=19)
taylor.diagram(obs1, mdl29, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkorchid4", pch=19)
taylor.diagram(obs1, mdl30, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="darkred", pch=19)
taylor.diagram(obs1, mdl31, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="deeppink4", pch=19)
taylor.diagram(obs1, mdl32, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="deepskyblue4", pch=19)
taylor.diagram(obs1, mdl33, add=TRUE, pcex=1.4, normalize=TRUE, sd.method=TRUE, col="black", pch=19)

legend(2.35,2.17, inset=c(-0.3,0), c("BCC-CSM1.1","BCC-CSM1.1M","BNU-ESM","Can-ESM2","CNRM-CM5","CSIRO-ACESS-1","CSIRO-ACESS-3","CSIRO-MK36","FIO-ESM",
                                     "GISS-E2-H","GISS-E2-H-CC","GISS-E2-R","HadGEM-AO","HadGEM-CC","HadGEM-ES","INMCM4","IPSL-CM5A-LR","IPSL-CM5A-MR","IPSL-CM5B-LR","LASG-FGOALS-G2",
                                     "LASG-FGOALS-S2","MIROC5","MIROC-ESM","MIROC5-ESM-CHEM","MPI-ESM-LR","MPI-ESM-MR","MRI-CGCM3","NCAR-CCSM4","NCAR-CESM1-BGC","NCAR-CESM1-CAM5",
                                     "NoESM1-M","NorESM1-ME","ENSEMEAN-CMIP5"), pch=19, col=c("antiquewhite4","aquamarine4","azure4","bisque3","violet","yellow","brown","coral",
                                                                                              "darkgray","green","red","darkkhaki","darkolivegreen1","yellowgreen","aliceblue","turquoise3","blue","peachpuff3","slategray2","wheat4",
                                                                                              "yellow4","violetred4","darkblue","cyan","darkolivegreen","darkmagenta","darkorange4","gray","darkorchid4","darkred","deeppink4","deepskyblue4","black"), title="CMIP5-hist MODELS", cex=0.6) 
dev.off()

# Calculate statistic methods (monthly end seasonal Skill)
error1 = gof(sim=mdl1, obs=obs1, na.rm=TRUE)
error2 = gof(sim=mdl2, obs=obs1, na.rm=TRUE)
error3 = gof(sim=mdl3, obs=obs1, na.rm=TRUE)
error4 = gof(sim=mdl4, obs=obs1, na.rm=TRUE)
error5 = gof(sim=mdl5, obs=obs1, na.rm=TRUE)
error6 = gof(sim=mdl6, obs=obs1, na.rm=TRUE)
error7 = gof(sim=mdl7, obs=obs1, na.rm=TRUE)
error8 = gof(sim=mdl8, obs=obs1, na.rm=TRUE)
error9 = gof(sim=mdl9, obs=obs1, na.rm=TRUE)
error10 = gof(sim=mdl10, obs=obs1, na.rm=TRUE)
error11 = gof(sim=mdl11, obs=obs1, na.rm=TRUE)
error12 = gof(sim=mdl12, obs=obs1, na.rm=TRUE)
error13 = gof(sim=mdl13, obs=obs1, na.rm=TRUE)
error14 = gof(sim=mdl14, obs=obs1, na.rm=TRUE)
error15 = gof(sim=mdl15, obs=obs1, na.rm=TRUE)
error16 = gof(sim=mdl16, obs=obs1, na.rm=TRUE)
error17 = gof(sim=mdl17, obs=obs1, na.rm=TRUE)
error18 = gof(sim=mdl18, obs=obs1, na.rm=TRUE)
error19 = gof(sim=mdl19, obs=obs1, na.rm=TRUE)
error20 = gof(sim=mdl20, obs=obs1, na.rm=TRUE)
error21 = gof(sim=mdl21, obs=obs1, na.rm=TRUE)
error22 = gof(sim=mdl22, obs=obs1, na.rm=TRUE)
error23 = gof(sim=mdl23, obs=obs1, na.rm=TRUE)
error24 = gof(sim=mdl24, obs=obs1, na.rm=TRUE)
error25 = gof(sim=mdl25, obs=obs1, na.rm=TRUE)
error26 = gof(sim=mdl26, obs=obs1, na.rm=TRUE)
error27 = gof(sim=mdl27, obs=obs1, na.rm=TRUE)
error28 = gof(sim=mdl28, obs=obs1, na.rm=TRUE)
error29 = gof(sim=mdl29, obs=obs1, na.rm=TRUE)
error30 = gof(sim=mdl30, obs=obs1, na.rm=TRUE)
error31 = gof(sim=mdl31, obs=obs1, na.rm=TRUE)
error32 = gof(sim=mdl32, obs=obs1, na.rm=TRUE)
error33 = gof(sim=mdl33, obs=obs1, na.rm=TRUE)

errorp1 = cbind(error1,error12,error3,error4,error5,error6,error7,error8,error9,error10,error11,error12,error13,error14,error15,error16)
errorp2 = cbind(error17,error18,error19,error20,error21,error22,error23,error24,error25,error26,error27,error28,error29,error30,error31,error32,error33)
errorp1
errorp2
# THE END # 

